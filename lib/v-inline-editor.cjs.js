"use strict";var e,t=(e=require("vue"))&&"object"==typeof e&&"default"in e?e.default:e,o=JSON.parse(JSON.stringify({buttons:{bold:{className:"bold",action:"bold",title:"加粗",native:!0,active:!1},italic:{className:"italic",action:"italic",title:"斜体",native:!0,active:!1},underline:{className:"underline",action:"underline",title:"下划线",native:!0,active:!1},strikeThrough:{className:"strikethrough",action:"strikeThrough",title:"删除线",native:!0,active:!1},superscript:{className:"superscript",action:"superscript",title:"上标",native:!0,active:!1},subscript:{className:"subscript",action:"subscript",title:"下标",native:!0,active:!1},justifyLeft:{className:"align-left",action:"justifyLeft",title:"左对齐",native:!0,active:!1},justifyCenter:{className:"align-center",action:"justifyCenter",title:"居中对齐",native:!0,active:!1},justifyRight:{className:"align-right",action:"justifyRight",title:"右对齐",native:!0,active:!1},link:{className:"link",title:"链接"},unLink:{className:"unlink",action:"unLink",title:"取消链接"},removeFormat:{className:"eraser",action:"removeFormat",title:"清除样式",native:!0}},selects:{fontName:{className:"",value:""},fontSize:{className:"",value:""}},colorPickers:{foreColor:{className:"fore-color",value:"",title:"文字颜色"},backColor:{className:"back-color",value:"",title:"文字背景"}}}));var n={toolbar:["fontName","fontSize","foreColor","backColor","bold","italic","underline","strikeThrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","removeFormat"],fontName:[{value:"微软雅黑",label:"微软雅黑"},{value:"宋体",label:"宋体"},{value:"仿宋",label:"仿宋"},{value:"serif",label:"Serif"},{value:"Helvetica",label:"Helvetica"}],fontSize:[{value:"12px",label:"12px"},{value:"14px",label:"14px"},{value:"16px",label:"16px"},{value:"18px",label:"18px"},{value:"20px",label:"20px"},{value:"24px",label:"24px"},{value:"28px",label:"28px"},{value:"32px",label:"32px"},{value:"48px",label:"48px"}]};function i(e){var t=JSON.parse(JSON.stringify(n));return e?t[e]:t}var a,l=!t.prototype.$isServer&&document.addEventListener?function(e,t,o){e&&t&&o&&e.addEventListener(t,o,!1)}:function(e,t,o){e&&t&&o&&e.attachEvent("on"+t,o)},r=[],s="@@clickoutsideContext",c=0;function u(e,t,o,n,i,a,l,r,s,c){"boolean"!=typeof l&&(s=r,r=l,l=!1);var u,d="function"==typeof o?o.options:o;if(e&&e.render&&(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,i&&(d.functional=!0)),n&&(d._scopeId=n),a?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,s(e)),e&&e._registeredComponents&&e._registeredComponents.add(a)},d._ssrRegister=u):t&&(u=l?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,r(e))}),u)if(d.functional){var f=d.render;d.render=function(e,t){return u.call(t),f(e,t)}}else{var h=d.beforeCreate;d.beforeCreate=h?[].concat(h,u):[u]}return o}!t.prototype.$isServer&&l(document,"mousedown",(function(e){return a=e})),!t.prototype.$isServer&&l(document,"mouseup",(function(e){r.forEach((function(t){return t[s].documentHandler(e,a)}))}));var d=u({render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.closeColorPanel,expression:"closeColorPanel"}],staticClass:"color-picker"},[o("button",{staticClass:"color-picker__trigger",on:{click:e.toggleStatus}},[e._t("icon")],2),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.inputColor,expression:"inputColor"}],ref:"colorPickerInput",staticClass:"color-picker__input",attrs:{type:"color"},domProps:{value:e.inputColor},on:{change:function(t){return e.updateValue(e.inputColor)},input:function(t){t.target.composing||(e.inputColor=t.target.value)}}}),e._v(" "),o("div",{staticClass:"color-picker__panel",class:{open:e.openStatus},style:e.position+": 0"},[o("div",{staticClass:"color-picker__panel-header"},["transparent"===e.showPanelColor?o("div",{staticClass:"color-transparent"}):o("div",{staticClass:"color-view",style:"background-color: "+e.showPanelColor}),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.showPanelColor,expression:"showPanelColor"}],staticClass:"color-value",attrs:{type:"text",readonly:""},domProps:{value:e.showPanelColor},on:{input:function(t){t.target.composing||(e.showPanelColor=t.target.value)}}})]),e._v(" "),o("div",{staticClass:"color-picker__panel-body"},[o("h3",[e._v("主题颜色")]),e._v(" "),o("ul",{staticClass:"theme-color"},[o("button",{staticClass:"button-transparent",on:{mouseover:function(t){e.hoverColor="transparent"},mouseout:function(t){e.hoverColor=null},click:function(t){return e.updateValue("transparent")}}},[o("i",{staticClass:"iconfont icon-slash"})]),e._v(" "),e._l(e.themeColor,(function(t,n){return o("button",{key:n,style:{backgroundColor:t},on:{mouseover:function(o){e.hoverColor=t},mouseout:function(t){e.hoverColor=null},click:function(o){return e.updateValue(t)}}})}))],2),e._v(" "),o("h3",[e._v("标准颜色")]),e._v(" "),o("ul",{staticClass:"base-color"},e._l(e.colorPanel,(function(t,n){return o("li",{key:n},[o("ul",e._l(t,(function(t){return o("button",{key:t,style:{backgroundColor:t},on:{mouseover:function(o){e.hoverColor=t},mouseout:function(t){e.hoverColor=null},click:function(o){return e.updateValue(t)}}})})),0)])})),0),e._v(" "),o("button",{staticClass:"more-color",on:{click:e.showMoreColor}},[e._v("\n        更多颜色\n      ")])])])])},staticRenderFns:[]},void 0,{name:"ColorPicker",directives:{Clickoutside:{bind:function(e,t,o){r.push(e);var n=c++;e[s]={id:n,documentHandler:function(n,i){void 0===n&&(n={}),void 0===i&&(i={}),!(o.context&&n.target&&i.target)||e.contains(n.target)||e.contains(i.target)||e===n.target||o.context.popperElm&&(o.context.popperElm.contains(n.target)||o.context.popperElm.contains(i.target))||(t.expression&&e[s].methodName&&o.context[e[s].methodName]?o.context[e[s].methodName]():e[s].bindingFn&&e[s].bindingFn())},methodName:t.expression,bindingFn:t.value}},update:function(e,t){e[s].methodName=t.expression,e[s].bindingFn=t.value},unbind:function(e){for(var t=r.length,o=0;o<t;o++)if(r[o][s].id===e[s].id){r.splice(o,1);break}}}},props:{value:{type:String,required:!0},defaultColor:{type:String,default:"#666"},position:{type:String,default:"left"}},data:function(){return{openStatus:!1,hoverColor:null,themeColor:["#000","#fff","#ffebcd","#ff8000","#ffc12a","#448026","#ffff00","#ff0000","#0000ff"],colorPanel:[["#400000","#804000","#004000","#004040"],["#808000","#808040","#808080","#408080"],["#ff8080","#ff0000","#804040","#800000"],["#ffff90","#ffff00","#ff8040","#ff8000"],["#80ff80","#80ff00","#00ff00","#008000"],["#00ff80","#00ff40","#008080","#008040"],["#80ffff","#00ffff","#004080","#0000ff"],["#0080ff","#0080c0","#8080ff","#0000a0"],["#ff80c0","#8080c0","#800040","#800080"],["#ff80ff","#ff00ff","#ff0080","#8000ff"]],inputColor:this.value}},computed:{showPanelColor:function(){return this.hoverColor?this.hoverColor:this.showColor},showColor:function(){return this.value||""}},methods:{closeColorPanel:function(){this.openStatus=!1},toggleStatus:function(){this.openStatus=!this.openStatus},showMoreColor:function(){this.$refs.colorPickerInput.click()},updateValue:function(e){e&&(this.$emit("input",e),this.$emit("change",e),this.openStatus=!1)},handleDefaultColor:function(){this.updateValue(this.defaultColor)},parseColor:function(e){if(4!==e.length)return e;e="#"+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]},rgbToHex:function(e,t,o){var n=(e<<16|t<<8|o).toString(16);return"#"+new Array(Math.abs(n.length-7)).join("0")+n},hexToRgb:function(e){e=this.parseColor(e);for(var t=[],o=1;o<7;o+=2)t.push(parseInt("0x"+e.slice(o,o+2)));return t},gradient:function(e,t,o){for(var n=this.hexToRgb(e),i=this.hexToRgb(t),a=(i[0]-n[0])/o,l=(i[1]-n[1])/o,r=(i[2]-n[2])/o,s=[],c=0;c<o;c++)s.push(this.rgbToHex(parseInt(a*c+n[0]),parseInt(l*c+n[1]),parseInt(r*c+n[2])));return s}}},void 0,!1,void 0,!1,void 0,void 0,void 0),f=u({render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{ref:"toolbar",staticClass:"vie-toolbar",staticStyle:{top:"-9999px"}},[e._l(e.toolbar,(function(t,n){return[t in e.buttons?o("button",{key:n,staticClass:"button",class:{active:e.buttons[t].active},attrs:{title:e.buttons[t].title,unselectable:"on"},on:{click:function(o){return o.stopPropagation(),e.btnHandler(o,t)}}},[o("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[o("use",{attrs:{"xlink:href":"#icon-"+[e.buttons[t].className]}})])]):t in e.selects?o("select",{directives:[{name:"model",rawName:"v-model",value:e.selects[t].value,expression:"selects[item].value"}],key:n,staticClass:"select",attrs:{unselectable:"on"},on:{change:[function(o){var n=Array.prototype.filter.call(o.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.selects[t],"value",o.target.multiple?n:n[0])},function(o){return e.selectHandler(o,t)}]}},e._l(e.config[t],(function(t,n){return o("option",{key:n,domProps:{value:t.value}},[e._v("\n        "+e._s(t.label)+"\n      ")])})),0):t in e.colorPickers?o("color-picker",{key:n,attrs:{title:e.colorPickers[t].title,unselectable:"on"},on:{change:function(o){return e.colorPickerHandle(o,t)}},model:{value:e.colorPickers[t].value,callback:function(o){e.$set(e.colorPickers[t],"value",o)},expression:"colorPickers[item].value"}},[o("svg",{staticClass:"icon",attrs:{slot:"icon","aria-hidden":"true"},slot:"icon"},[o("use",{attrs:{"xlink:href":"#icon-"+[e.colorPickers[t].className]}})])]):e._e()]}))],2)},staticRenderFns:[]},void 0,{name:"VieToolbar",components:{ColorPicker:d},props:{},data:function(){var e=o;return{options:null,buttons:e.buttons,selects:e.selects,colorPickers:e.colorPickers,config:i(),toolbar:i("toolbar")}},mounted:function(){this.options&&(this.options.toolbar&&(this.toolbar=this.options.toolbar,this.config.toolbar=this.options.toolbar),this.options.fontSize&&(this.config.fontSize=this.options.fontSize),this.options.fontName&&(this.config.fontName=this.options.fontName))},methods:{btnHandler:function(e,t){var o=this.buttons[t];o.action&&o.native&&this.$emit("execCommand",{name:t,value:null})},selectHandler:function(e,t){this.$emit("execCommand",{name:t,value:this.selects[t].value})},colorPickerHandle:function(e,t){this.$emit("execCommand",{name:t,value:e})}}},void 0,!1,void 0,!1,void 0,void 0,void 0);!function(e){var t,o='<svg><symbol id="icon-underline" viewBox="0 0 1024 1024"><path d="M0 945.230769 945.230769 945.230769 945.230769 1024 0 1024 0 945.230769ZM0 0 407.076943 0 407.076943 61.934356 319.153861 68.127823 299.076923 86.088783 299.076923 530.158041C299.076923 614.802038 317.076716 675.290663 353.076933 711.625649 389.077071 747.960635 448.153442 766.127892 530.307702 766.127892 606.000364 766.127892 660.807522 746.825177 694.730752 708.219274 728.653982 669.613371 745.61536 606.337733 745.61536 518.390469L745.61536 91.043525 724.153817 69.366469 633.461524 61.934356 633.461524 0 955.384596 0 955.384596 61.934356 868.846119 69.366469 849.461563 91.043525 849.461563 531.396687C849.461563 649.072561 819.923338 734.334661 760.846178 787.185585 701.76894 840.03651 606.462188 866.461538 474.923087 866.461538 406.153531 866.461538 345.807951 857.481137 293.884613 839.520098 241.961275 821.55906 201.230887 795.856581 171.692347 762.411796 149.076834 735.986373 133.038474 705.74206 123.57695 671.677991 114.115348 637.613922 109.384625 588.789524 109.384625 525.203298L109.384625 86.088783 89.307687 68.127823 0 61.934356 0 0Z"  ></path></symbol><symbol id="icon-italic" viewBox="0 0 1024 1024"><path d="M897.948 61.745l0 64.322-128.65 0L447.674 897.933l128.65 0 0 64.32L126.052 962.253l0-64.32 128.65 0 321.622-771.866-128.65 0L447.674 61.745 897.948 61.745z"  ></path></symbol><symbol id="icon-eraser" viewBox="0 0 1024 1024"><path d="M674.37504 69.888a20.224 20.224 0 0 0-28.48 0L6.08704 709.76a20.224 20.224 0 0 0 0 28.544l124.416 124.416a56.128 56.128 0 0 0 34.432 14.272h398.656c11.072 0 26.56-6.4 34.432-14.272l420.288-420.352a20.224 20.224 0 0 0 0-28.544l-343.936-343.936zM558.47104 786.816a56.128 56.128 0 0 1-34.496 14.272H215.36704a56.128 56.128 0 0 1-34.432-14.272l-58.624-58.688a20.224 20.224 0 0 1 0-28.544l234.496-234.56a20.224 20.224 0 0 1 28.544 0l233.152 233.216a20.224 20.224 0 0 1 0 28.48l-60.032 60.096z" fill="#666666" ></path></symbol><symbol id="icon-bold" viewBox="0 0 1024 1024"><path d="M163.89832738 853.08066132v-683.98678637c7.86353164-67.26127551-39.59849673-98.92602915-142.38608023-95.27510424v-56.02765746h539.77524244c245.17366619 3.72113633 371.62205369 86.00737034 379.6260058 246.64807746 0 119.63800812-79.12678203 190.62041997-237.23992553 213.0174397 197.64142881 29.97971286 296.56745795 112.12552887 296.56746036 246.6480799-11.86550645 183.17814974-140.42019855 276.69800181-385.59386476 280.34892423h-593.13491831v-56.09786893c102.78758595 3.79134534 150.24961188-28.01382876 142.38608023-95.27510429z m243.13757553-336.37658413v313.97956197c-3.93176586 74.77375474 31.66475361 110.22985619 106.78956074 106.50872232 150.24961188-3.72113633 225.4446281-67.33148452 225.44462812-190.62041999-4.00197481-153.19843689-79.19699103-229.86786431-225.44462812-229.8678643h-106.78956074z m0-336.37658662v274.73212011h47.46202592c154.25158671 0 229.30618487-59.7487938 225.44462803-179.38680435-4.00197481-123.35914447-61.36362558-186.82907463-172.01474319-190.62042003-67.33148452 0-100.89191329 31.80517407-100.89191076 95.27510427z" fill="#8FA6BF" ></path></symbol><symbol id="icon-back-color" viewBox="0 0 1024 1024"><path d="M327 167h-1.9c-2.8 17.7-5.9 31.4-9.5 41l-88 244.3h197.2L336.1 208c-2.8-7.9-5.8-21.5-9.1-41zM203.6 518.6l-56.5 160.7h361.2l-60-160.7z" fill="#656565" ></path><path d="M592.3 91.8H64v585.7L287.1 91.8h81.3l223.7 587.5h0.2z" fill="#656565" ></path><path d="M64 677.5l-0.7 1.9h83.8v-0.1H64zM508.3 679.4h83.8v-0.1h-83.8z" fill="" ></path><path d="M287.1 91.8L64 677.5v1.8h83.1l56.5-160.8h244.7l60 160.8h83.8L368.4 91.8h-81.3z m-59.5 360.4l88-244.3c3.6-9.6 6.7-23.3 9.5-41h1.9c3.3 19.5 6.4 33.1 9.1 41l88.7 244.3H227.6zM502 886H64.4V702.8H502V886z m-377.6-60H442v-63.2H124.4V826zM959.3 703.8L743.7 926.2 528 703.8z" fill="#919191" ></path></symbol><symbol id="icon-fore-color" viewBox="0 0 1024 1024"><path d="M388.4 87.8h-81.3L83.3 675.4h83.8l56.5-160.8h244.7l60 160.8h83.8L388.4 87.8zM247.6 448.2l88-244.3c3.6-9.6 6.7-23.3 9.5-41h1.9c3.3 19.5 6.4 33.1 9.1 41l88.7 244.3H247.6z" fill="#919191" ></path><path d="M84 704.8h429v173.6H84z" fill="#656565" ></path><path d="M548 704.8l215.7 222.4 215.6-222.4z" fill="#919191" ></path></symbol><symbol id="icon-align-left" viewBox="0 0 1024 1024"><path d="M1000.15484777 196.33978785H27.32487111V69.5786003H1000.15484777v126.76118755zM634.61866509 450.41228994H27.32487111V323.65110239H634.61866509v126.76118755z m365.53618268 252.97224814H27.32487111V576.62335052H1000.15484777v126.76118756z m-365.53618268 254.07250209H27.32487111v-126.76118756H634.61866509v126.76118756z" fill="" ></path></symbol><symbol id="icon-align-right" viewBox="0 0 1024 1024"><path d="M34.02666667 76.05333333h956.05333333v124.58666667H34.02666667zM393.17333333 325.76h596.8v124.58666667H393.17333333zM34.02666667 574.4h956.05333333v124.58666667H34.02666667zM393.17333333 824h596.8v124.58666667H393.17333333z"  ></path></symbol><symbol id="icon-align-center" viewBox="0 0 1024 1024"><path d="M34.45333333 77.86666667h954.56v124.37333333H34.45333333zM213.76 327.25333333H809.6v124.37333334H213.76zM34.45333333 575.46666667h954.56v124.37333333H34.45333333zM213.76 824.74666667H809.6v124.37333333H213.76z"  ></path></symbol><symbol id="icon-subscript" viewBox="0 0 1024 1024"><path d="M781.2 383h-26.6c-4.9-47.4-18.1-82.1-39.5-104.1C688 251.1 649.3 237.2 599.2 237.2H480v507c0 51.5 5.8 84.3 17.3 98.2 14.8 17.2 39.1 25.8 72.8 25.8h29.6v23.4H240.6v-23.4h30.7c34.4 0 59.8-11 76.2-33.1 8.2-13.9 12.3-44.2 12.3-90.8V237.3H259.3c-55.6 0-93.5 9-114 27-30.2 22-47.8 61.7-52.7 118.8H63.9l-0.3-208.7h717.3l0.3 208.6zM901 134.8h19.9V323.9c0 8.9 0.6 14.7 1.7 17.2 1.1 2.6 3 4.5 5.6 5.8s7.8 2 15.5 2h16v18.8H844.5v-18.8h17.8c7.7 0 12.9-0.7 15.4-2 2.6-1.4 4.5-3.5 6-6.5 1.4-3 2.1-8.5 2.1-16.4V173.5h-41.3v-19.1c22.5-3.2 41.4-9.7 56.5-19.6z"  ></path></symbol><symbol id="icon-strikethrough" viewBox="0 0 1024 1024"><path d="M959.6 324.6h-33.2c-6.2-59.1-22.6-102.5-49.3-130-33.9-34.7-82.1-52-144.7-52H583.5v633c0 64.4 7.2 105.2 21.6 122.6 18.5 21.5 48.8 32.2 90.9 32.2h37v29.2H284.6v-29.2h38.3c43 0 74.7-13.8 95.1-41.4 10.2-17.4 15.3-55.1 15.3-113.4v-633H307.9c-69.4 0-116.8 11.2-142.3 33.7-37.7 27.5-59.7 77-65.8 148.4H64L63.6 64h895.7l0.3 260.6z"  ></path><path d="M65.9 439.5H959v91.6H65.9z"  ></path></symbol><symbol id="icon-superscript" viewBox="0 0 1024 1024"><path d="M875.8 325.2h-30.1c-5.6-53.5-20.5-92.8-44.6-117.7-30.7-31.4-74.3-47.1-131-47.1H535.4v573.1c0 58.3 6.5 95.3 19.5 111 16.7 19.4 44.2 29.1 82.3 29.1h33.5v26.5h-406v-26.5h34.7c38.9 0 67.6-12.5 86.1-37.5 9.2-15.7 13.9-49.9 13.9-102.7v-573H285.8c-62.8 0-105.7 10.2-128.8 30.5-34.2 24.9-54 69.7-59.6 134.4H64.9l-0.3-236h811l0.2 235.9zM893.2 670.4h22.5v213.7c0 10.1 0.6 16.6 1.9 19.5 1.3 2.9 3.4 5.1 6.4 6.6 3 1.5 8.8 2.2 17.5 2.2h18.1v21.2H829.3v-21.2h20.1c8.7 0 14.6-0.8 17.4-2.3 2.9-1.5 5.1-4 6.7-7.4 1.6-3.4 2.4-9.6 2.4-18.5v-170h-46.7v-21.6c25.6-3.6 46.9-11 64-22.2z"  ></path></symbol></svg>',n=(t=document.getElementsByTagName("script"))[t.length-1].getAttribute("data-injectcss");if(n&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(e){console&&console.log(e)}}!function(t){if(document.addEventListener)if(~["complete","loaded","interactive"].indexOf(document.readyState))setTimeout(t,0);else{var o=function(){document.removeEventListener("DOMContentLoaded",o,!1),t()};document.addEventListener("DOMContentLoaded",o,!1)}else document.attachEvent&&function(e,t){var o=e.document,n=!1,i=function(){n||(n=!0,t())},a=function(){try{o.documentElement.doScroll("left")}catch(e){return void setTimeout(a,50)}i()};a(),o.onreadystatechange=function(){"complete"==o.readyState&&(o.onreadystatechange=null,i())}}(e,t)}((function(){var e,t,n,i;(e=document.createElement("div")).innerHTML=o,o=null,(t=e.getElementsByTagName("svg")[0])&&(t.setAttribute("aria-hidden","true"),t.style.position="absolute",t.style.width=0,t.style.height=0,t.style.overflow="hidden",n=t,(i=document.body).firstChild?function(e,t){t.parentNode.insertBefore(e,t)}(n,i.firstChild):i.appendChild(n))}))}(window);var h=u({render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{ref:"vueInlineEditor",staticClass:"vue-inline-editor"},[o("div",{ref:"editContent",staticClass:"vie-editor-content",attrs:{contenteditable:"true"},on:{keyup:e.handleKeyup,paste:function(t){return t.stopPropagation(),e.handlePaste(t)},mouseup:e.handleMouseup}})])},staticRenderFns:[]},void 0,{name:"VueInlineEditor",props:{value:{type:String,required:!0},options:{type:Object,default:null},pastePlain:{type:Boolean,default:!1}},data:function(){return{currentValue:this.value,editContent:null,toolbar:null}},mounted:function(){this.editContent=this.$refs.editContent,this.editContent.innerHTML=this.value,this.initToolbar(),document.addEventListener("click",this.bindClickEvent)},beforeDestroy:function(){this.toolbar.$el.remove()},destroyed:function(){document.removeEventListener("click",this.bindClickEvent)},methods:{setCurrentVal:function(e){this.$emit("input",e),this.$emit("change",e),this.currentValue=e},execCommand:function(e){var t=e.name,o=e.value;if(this[t])this[t](t,o);else{var n=this.getSelection(),i=this.getRange();if(!n||!i)return;document.queryCommandSupported("styleWithCss")&&document.execCommand("styleWithCss",!1,!0),document.execCommand(t,!1,o)}this.updateButtonState();var a=this.editContent.innerHTML;this.setCurrentVal(a)},getSelection:function(){if(document.getSelection)return document.getSelection()},getRange:function(){var e,t=this.getSelection();return t&&0!==t.rangeCount&&(e=t.getRangeAt(0)),e},fontSize:function(e,t){var o=this,n=this.getSelection(),i=this.getRange();if(n&&i&&!i.collapsed){var a=i.cloneContents().childNodes;if(1===a.length&&1===a[0].nodeType&&"span"===a[0].tagName.toLowerCase()){var l=i.extractContents().childNodes[0];l.style.fontSize=t,i.insertNode(l),i.selectNode(l),n.removeAllRanges(),n.addRange(i)}else if(-1!==navigator.userAgent.indexOf("Chrome")&&-1===navigator.userAgent.indexOf("Edge")){document.queryCommandSupported("styleWithCss")&&document.execCommand("styleWithCss",!1,!0),document.execCommand("fontSize",!1,7);var r=i.commonAncestorContainer;3===r.nodeType&&(r=r.parentNode),"span"===r.tagName.toLowerCase()&&(r=r.parentNode),Array.prototype.forEach.call(r.getElementsByTagName("span"),(function(e){"-webkit-xxx-large"!==e.style.fontSize.trim()&&"xxx-large"!==e.style.fontSize.trim()||(e.style.fontSize=t),e.normalize()}))}else{document.queryCommandSupported("styleWithCss")&&document.execCommand("styleWithCss",!1,!1),document.execCommand("fontSize",!1,7);var s,c=[],u=i.commonAncestorContainer;3===u.nodeType&&(u=u.parentNode),"font"===u.tagName.toLowerCase()&&(u=u.parentNode),s=u.getElementsByTagName("font");for(var d=function(e){var n=s[e],i=document.createElement("span");Array.prototype.forEach.call(n.attributes,(function(e){"size"===e.nodeName?i.style.fontSize=t:i.setAttribute(e.nodeName,e.nodeValue)})),i.innerHTML=n.innerHTML,0!==i.querySelectorAll("span").length&&o.formatContent(i,"span","fontSize"),i.normalize(),n.parentNode.replaceChild(i,n),c.push(i),e--,f=e},f=0;f<s.length;f++)d(f);i.setStartBefore(c[0]),i.setEndAfter(c[c.length-1]),n.removeAllRanges(),n.addRange(i)}}},formatContent:function(e,t,o){for(var n=[],i={fontSize:/font-size:\s?\d+px;/g,verticalAlign:/vertical-align:\s?(sub|super);/g},a=e.getElementsByTagName(t),l=0;l<a.length;l++){var r=a[l];if(1===r.attributes.length&&0!==r.style.length&&null!=r.getAttribute("style").match(i[o]))if(0===r.children.length)if(1===r.style.length){var s=r.parentNode;s.replaceChild(document.createTextNode(r.innerHTML),r),s.normalize(),l--}else r.style[o]="";else n.push(r)}n.length&&this.formatContent(e,t,o)},showToolbar:function(){var e=window.getSelection().getRangeAt(0),t=this.toolbar.$el,o=window.innerWidth-t.clientWidth-2,n=e.getBoundingClientRect(),i=(n.right-n.left)/2+n.left-t.clientWidth/2,a=n.top-(t.clientHeight+8)+window.pageYOffset;i=i<2?2:i>o?o:i,t.style.top=a+"px",t.style.left=i+"px"},hideToolbar:function(){this.toolbar.$el.style.top="-9999px"},handleKeyup:function(e){var t=e.target.innerHTML;this.toolbar.$el.style.top="-9999px",this.setCurrentVal(t)},handleMouseup:function(){var e=this;setTimeout((function(){window.getSelection().isCollapsed?e.hideToolbar():(e.updateButtonState(),e.showToolbar())}),1)},handlePaste:function(e){if(this.pastePlain){e.preventDefault();var t=(e.clipboardData||window.clipboardData).getData("text/plain");document.queryCommandSupported("insertText")?document.execCommand("insertText",!1,t):document.execCommand("paste",!1,t)}},rgbToHex:function(e){var t=e.match(/\((.+)\)/);if(t){t=t[1].split(",");var o=(parseInt(t[0].trim())<<16|parseInt(t[1].trim())<<8|parseInt(t[2].trim())).toString(16);return"#"+new Array(Math.abs(o.length-7)).join("0")+o}return""},updateButtonState:function(){var e=this.toolbar.buttons,t=this.toolbar.selects,o=this.toolbar.colorPickers,n=document,i={is_bold:n.queryCommandValue("bold"),is_italic:n.queryCommandValue("italic"),is_underline:n.queryCommandValue("underline"),is_strikeThrough:n.queryCommandValue("strikeThrough"),is_superscript:n.queryCommandValue("superscript"),is_subscript:n.queryCommandValue("subscript"),is_justifyLeft:n.queryCommandValue("justifyLeft"),is_justifyCenter:n.queryCommandValue("justifyCenter"),is_justifyRight:n.queryCommandValue("justifyRight")};for(var a in e)e[a].hasOwnProperty("active")&&(e[a].active="true"===i["is_"+a]);var l=n.queryCommandValue("fontName");t.fontName.value=l.split(",")[0]||"",t.fontSize.value=this.updateFontSize()||"";var r=n.queryCommandValue("foreColor"),s=n.queryCommandValue("backColor");o.foreColor.value=this.rgbToHex(r)||"",o.backColor.value=this.rgbToHex(s)||""},getFontSize:function(e){return 3===e.nodeType&&(e=e.parentNode),e.style.fontSize||this.getWindow(e).getComputedStyle(e,"").getPropertyValue("font-size")},getWindow:function(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},updateFontSize:function(){var e=window.getSelection().getRangeAt(0).startContainer,t=this.getFontSize(e),o=/^([\d]+)(\w+)$/.exec(t);return o?Math.floor(o[1])+o[2]:t},bindClickEvent:function(e){var t=e.path||e.composedPath&&e.composedPath();if(t){var o=t.includes(this.toolbar.$el),n=t.includes(this.editContent);o||n||this.hideToolbar()}},initToolbar:function(){var e=new t(f);e.$on("execCommand",this.execCommand),e.$data.options=this.options;var o=e.$mount();document.body.appendChild(o.$el),this.toolbar=o}}},void 0,!1,void 0,!1,void 0,void 0,void 0);h.install=function(e){e.component(h.name,h)},module.exports=h;
